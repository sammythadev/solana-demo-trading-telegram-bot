file & folder tree

Axel-Solana-Demo-Trading-Bot/
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ bot/
â”‚   â”‚   â”œâ”€â”€ commands/
â”‚   â”‚   â”‚   â”œâ”€â”€ start.js
â”‚   â”‚   â”‚   â”œâ”€â”€ token.js
â”‚   â”‚   â”‚   â”œâ”€â”€ buy.js
â”‚   â”‚   â”‚   â”œâ”€â”€ sell.js
â”‚   â”‚   â”‚   â”œâ”€â”€ portfolio.js
â”‚   â”‚   â”‚   â”œâ”€â”€ balance.js
â”‚   â”‚   â”‚   â”œâ”€â”€ topup.js
â”‚   â”‚   â”‚   â”œâ”€â”€ settings.js
â”‚   â”‚   â”‚   â””â”€â”€ help.js
â”‚   â”‚   â”œâ”€â”€ middlewares/
â”‚   â”‚   â”‚   â””â”€â”€ userMiddleware.js
â”‚   â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”‚   â”œâ”€â”€ formatters.js
â”‚   â”‚   â”‚   â”œâ”€â”€ speedDelay.js
â”‚   â”‚   â”‚   â””â”€â”€ dexApi.js
â”‚   â”‚   â”œâ”€â”€ bot.js
â”‚   â”‚   â””â”€â”€ index.js
â”‚   â”‚
â”‚   â”œâ”€â”€ db/
â”‚   â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”‚   â”œâ”€â”€ User.js
â”‚   â”‚   â”‚   â”œâ”€â”€ Position.js
â”‚   â”‚   â”‚   â””â”€â”€ Transaction.js
â”‚   â”‚   â”œâ”€â”€ migrations/
â”‚   â”‚   â”‚   â””â”€â”€ (auto-generated by Sequelize CLI)
â”‚   â”‚   â””â”€â”€ index.js
â”‚   â”‚
â”‚   â”œâ”€â”€ cache/
â”‚   â”‚   â””â”€â”€ redisClient.js
â”‚   â”‚
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”œâ”€â”€ database.js
â”‚   â”‚   â”œâ”€â”€ redis.js
â”‚   â”‚   â”œâ”€â”€ env.js
â”‚   â”‚   â””â”€â”€ constants.js
â”‚   â”‚
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ tradeService.js
â”‚   â”‚   â”œâ”€â”€ portfolioService.js
â”‚   â”‚   â”œâ”€â”€ balanceService.js
â”‚   â”‚   â””â”€â”€ userService.js
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â””â”€â”€ logger.js
â”‚   â”‚
```plaintext
file & folder tree

Axel-Solana-Demo-Trading-Bot/
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ bot/
â”‚   â”‚   â”œâ”€â”€ commands/
â”‚   â”‚   â”‚   â”œâ”€â”€ start.js
â”‚   â”‚   â”‚   â”œâ”€â”€ token.js
â”‚   â”‚   â”‚   â”œâ”€â”€ buy.js
â”‚   â”‚   â”‚   â”œâ”€â”€ sell.js
â”‚   â”‚   â”‚   â”œâ”€â”€ portfolio.js
â”‚   â”‚   â”‚   â”œâ”€â”€ positions.js
â”‚   â”‚   â”‚   â”œâ”€â”€ balance.js
â”‚   â”‚   â”‚   â”œâ”€â”€ trades.js
â”‚   â”‚   â”‚   â”œâ”€â”€ topup.js
â”‚   â”‚   â”‚   â”œâ”€â”€ settings.js
â”‚   â”‚   â”‚   â””â”€â”€ help.js
â”‚   â”‚   â”œâ”€â”€ middlewares/
â”‚   â”‚   â”‚   â””â”€â”€ userMiddleware.js
â”‚   â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”‚   â”œâ”€â”€ formatters.js
â”‚   â”‚   â”‚   â”œâ”€â”€ speedDelay.js
â”‚   â”‚   â”‚   â”œâ”€â”€ dexApi.js
â”‚   â”‚   â”‚   â””â”€â”€ tokenCache.js
â”‚   â”‚   â”œâ”€â”€ bot.js
â”‚   â”‚   â””â”€â”€ index.js
â”‚   â”‚
â”‚   â”œâ”€â”€ db/
â”‚   â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”‚   â”œâ”€â”€ User.js
â”‚   â”‚   â”‚   â”œâ”€â”€ Position.js
â”‚   â”‚   â”‚   â””â”€â”€ Transaction.js
â”‚   â”‚   â”œâ”€â”€ migrations/
â”‚   â”‚   â”‚   â””â”€â”€ (use migrations in production; not auto-run in prod)
â”‚   â”‚   â”œâ”€â”€ index.js
â”‚   â”‚   â””â”€â”€ pgPool.js
â”‚   â”‚
â”‚   â”œâ”€â”€ cache/
â”‚   â”‚   â””â”€â”€ redisClient.js
â”‚   â”‚
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”œâ”€â”€ database.js
â”‚   â”‚   â”œâ”€â”€ redis.js
â”‚   â”‚   â”œâ”€â”€ env.js
â”‚   â”‚   â””â”€â”€ constants.js
â”‚   â”‚
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ tradeService.js
â”‚   â”‚   â”œâ”€â”€ portfolioService.js
â”‚   â”‚   â”œâ”€â”€ balanceService.js
â”‚   â”‚   â””â”€â”€ userService.js
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â””â”€â”€ logger.js
â”‚   â”‚
â”‚   â””â”€â”€ index.js
â”‚
â”œâ”€â”€ .env
â”œâ”€â”€ package.json
â”œâ”€â”€ README.md
â”œâ”€â”€ .gitignore
â””â”€â”€ docker-compose.yml


ğŸ“„ Files in Root
File	              Description
-----------------------------------------------------------------------
package.json	      Node.js manifest file. Declares project metadata, dependencies, and scripts.
.env	              Environment variables â€” keeps secrets like BOT_TOKEN, DATABASE_URL, REDIS_URL.
.gitignore          	  Specifies files/folders Git should ignore (e.g., node_modules, .env).
README.md	          High-level documentation â€” quick start, features, and setup instructions.
docker-compose.yml	  Defines services (bot, PostgreSQL, Redis) for local or development deployment.
/src/ 	              Application source code.


-------------------------------------------------------------------------------------------------------------

ğŸ“‚ /src â€” Main Application Directory

The src/ directory contains all application logic â€” bot commands, database layer, caching, services, and utilities.

src/
â”‚
â”œâ”€â”€ bot/
â”œâ”€â”€ db/
â”œâ”€â”€ cache/
â”œâ”€â”€ config/
â”œâ”€â”€ services/
â”œâ”€â”€ utils/
â””â”€â”€ index.js
 ----------------------------------------------------------------------------------------------

ğŸ¤– /src/bot â€” Telegram Bot Logic

Handles Telegram interactions: commands, middleware, and inline callback handlers.
src/bot/
â”‚
â”œâ”€â”€ commands/
â”œâ”€â”€ middlewares/
â”œâ”€â”€ utils/
â”œâ”€â”€ bot.js
â””â”€â”€ index.js

ğŸ§© Files & Folder
| Path             | Description                                                                |
| ---------------- | -------------------------------------------------------------------------- |
| **bot.js**       | Instantiates Telegraf, registers command and action handlers, and configures polling options.   |
| **index.js**     | Starts the bot service (calls bot.launch) and wires graceful shutdown.      |
| **commands/**    | One module per Telegram command (start, buy, sell, portfolio, trades, etc.). |
| **middlewares/** | Middleware (user registration, auth) executed before command handlers.     |
| **utils/**       | Helper modules for API calls, caching, and message formatting.             |

---------------------------------------------------------------------------------------------------------

ğŸ“ /src/bot/commands (overview)

Each command file implements a specific Telegram command and any related inline action handlers.

| File             | Command (or action)        | Purpose / Notes                                                          |
| ---------------- | -------------------------- | ------------------------------------------------------------------------ |
| **start.js**     | `/start`                   | Register user, seed demo SOL balance, show welcome message.             |
| **token.js**     | `/token <mint>`            | Show token details from Dexscreener (price, liquidity, FDV).            |
| **buy.js**       | `/buy <mint>`              | Show quick buy inline buttons (0.1/0.5/1, Custom, Cancel).              |
|                  | `/buy <mint> <sol>`        | Execute buy. Custom option collects amount via follow-up message.       |
| **sell.js**      | `/sell <mint|symbol>`      | Show quick sell inline buttons (25/50/75/100, Custom, Cancel).          |
|                  | `/sell <mint|symbol> <pct>`| Execute sell of percent of position.                                    |
| **portfolio.js** | `/portfolio`               | Paginated positions (5 per page), fetches token metadata in batches.    |
| **positions.js** | `/positions`               | Compact list of positions (symbol â€” amount â€” $value â€” PnL%).            |
| **trades.js**    | `/trades [sold|buys|all]`  | Paginated trades view (10 per page). Shows total trades, PnL, win/loss stats. |
| **balance.js**   | `/balance`                 | Shows SOL balance and estimated USD value (uses getSolUsd).             |
| **topup.js**     | `/topup <amount>`          | Add demo SOL to the user's account (transaction recorded).              |
| **settings.js**  | `/settings`                | Configure execution speed (Turbo/Fast/Normal/Slow) â€” affects gas deduction. |
| **help.js**      | `/help`                    | Lists commands and developer contact.                                   |

Inline callback data patterns
- `buy:<mint>:<amount|custom|cancel>` â€” quick buy actions and cancel
- `sell:<mint>:<percent|custom|cancel>` â€” quick sell actions and cancel
- `portfolio:page:<n>` / `portfolio:refresh:<n>` / `portfolio:cancel:<n>` â€” portfolio controls
- `trades:page:<filter>:<n>` / `trades:refresh:<filter>` / `trades:cancel` â€” trades controls

-----------------------------------------------------------------------------------------------------------------------------------

ğŸ“ /src/bot/middlewares
| File                  | Purpose                                                                                    |
| --------------------- | ------------------------------------------------------------------------------------------ |
| **userMiddleware.js** | Ensures requests are tied to a registered user; populates `ctx.state.user`.               |

----------------------------------------------------------------------------------------------------------------------------------------

ğŸ“ /src/bot/utils

| File              | Purpose                                                                        |
| ----------------- | ------------------------------------------------------------------------------ |
| **dexApi.js**     | Dexscreener integration with: keep-alive HTTP agent, concurrency limiter, in-process cache and Redis backing. |
| **tokenCache.js** | LRU-backed in-process cache with in-flight dedupe, batching and Redis persistence. |
| **formatters.js** | Message and currency formatting helpers (fmtUSD, percent, PnL emoji).          |
| **speedDelay.js** | Implements execution delays per speed mode (affects simulated slippage/gas).    |

---------------------------------------------------------------------------------------------------------------

ğŸ—ƒï¸ /src/db â€” Database Layer

Manages persistence with Sequelize and provides a lightweight `pg.Pool` helper for raw queries.

src/db/
â”‚
â”œâ”€â”€ models/
â”œâ”€â”€ migrations/
â””â”€â”€ index.js
--------------------------------------------------------------------

ğŸ“ /src/db/models

| File               | Table          | Purpose                                                              |
| ------------------ | -------------- | -------------------------------------------------------------------- |
| **User.js**        | `users`        | Stores Telegram ID, virtual SOL balance, speed mode, timestamps.     |
| **Position.js**    | `positions`    | Tracks open positions: token_address, symbol, buy_price, amount_tokens, sol_spent. |
| **Transaction.js** | `transactions` | Records buys, sells, topups with pnl_usd, total_usd, created_at, type. |

`src/db/index.js` â€” creates a single Sequelize instance with pooled connections and idempotent init.
`src/db/pgPool.js` â€” exported `query` and `getClient` helpers using `pg.Pool` for fast raw SQL.

---------------------------------------------------------------------------------------------------------------------------------

âš¡ /src/cache â€” Redis Caching Layer

| File               | Purpose                                                                                |
| ------------------ | -------------------------------------------------------------------------------------- |
| **redisClient.js** | Manages Redis client lifecycle, provides `redisGet`, `redisSet`, and simple acquire/release lock helpers. |

Key naming (examples)
- `dex:{mint}` â€” raw Dexscreener response
- `token:{mint}` â€” parsed token metadata cached in Redis
- `portfolio:{userId}:page:{n}` â€” (recommended) cached rendered portfolio page snapshot

-------------------------------------------------------------------------------------------------------------------

âš™ï¸ /src/config â€” Configuration Files

| File             | Purpose                                                                 |
| ---------------- | ----------------------------------------------------------------------- |
| **database.js**  | Exposes DATABASE_URL and DB_POOL defaults. Tune via env vars (DB_POOL_MAX etc.). |
| **redis.js**     | Exposes REDIS_URL and other Redis-related env wiring.                   |
| **env.js**       | Loads `.env` via dotenv and exports ENV for runtime configuration.      |
| **constants.js** | Stores gas/fee constants, default balance, and speed presets.          |


------------------------------------------------------------------------------------------------------------

ğŸ’¼ /src/services â€” Business Logic Layer

| File                    | Purpose                                                                     |
| ----------------------- | --------------------------------------------------------------------------- |
| **tradeService.js**     | Executes buys/sells: validates, computes gas, updates positions & transactions, merges buys into existing positions. |
| **portfolioService.js** | Aggregation helpers for portfolio values (used by portfolio command).       |
| **balanceService.js**   | Computes SOL balance and USD estimate (uses getSolUsd).                     |
| **userService.js**      | User profile updates (speed setting), registration helper.                  |

-----------------------------------------------------------------------------------------------------------------

ğŸ§° /src/utils

| File          | Purpose                                                                                 |
| ------------- | --------------------------------------------------------------------------------------- |
| **logger.js** | Central logging helper used across services and commands.                              |

-----------------------------------------------------------------------------------------------------------------

ğŸš€ /src/index.js

| Purpose                                                                                                      |
| ------------------------------------------------------------------------------------------------------------ |
| Bootstraps environment, initializes DB and Redis, then starts the Telegraf bot.                              |

-------------------------------------------------------------------------------------------------------------------------

ğŸ³ /docker-compose.yml

| Purpose                                                                                |
| -------------------------------------------------------------------------------------- |
| Defines local development containers: Postgres, Redis, and an app service for the bot. |
| Simplifies running the full stack locally (`docker-compose up -d`).                   |

```
